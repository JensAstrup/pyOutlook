

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>&lt;no title&gt; &mdash; pyOutlook b0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="pyOutlook b0 documentation" href="index.html"/>
        <link rel="prev" title="Outlook Account" href="pyOutlook.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> pyOutlook
          

          
          </a>

          
            
            
              <div class="version">
                1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">pyOutlook</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">pyOutlook</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>&lt;no title&gt;</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/readme_link.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="highlight-default"><div class="highlight"><pre><span></span>pyOutlook
=========

A Python module for connecting to the Outlook REST API, without the
hassle of dealing with the JSON formatting for requests/responses and
the REST endpoints and their varying requirements

Methods
-------

All current methods available, with descriptions, parameters, and
examples.

Instantiation
^^^^^^^^^^^^^

Creating the object: Before anything can be retrieved or sent, the
OutlookAccount object must be created. The only parameter required is
the access token for the account. This can be changed later with the
method ``set_access_token(token_input)`` where &#39;token\_input&#39; is the
OAuth Access token you receive from Outlook. Note that this module does
not handle the OAuth process, gaining an access token must be done
outside of this module.

.. code:: python

    token = &#39;OAuth Access Token Here&#39;
    new_token = &#39;OAuth Access Token2 Here&#39;
    my_account = pyOutlook.OutlookAccount(token)
    # If our token is refreshed, or to ensure that the latest token is saved prior to calling a method. 
    my_account = my_account.set_access_token(new_token)

Retrieving Messages
~~~~~~~~~~~~~~~~~~~

get\_messages()
^^^^^^^^^^^^^^^

This method retrieves the five most recent emails, returning a list of
Message objects.

.. code:: python

    my_account.get_messages()

get\_more\_messages(page)
^^^^^^^^^^^^^^^^^^^^^^^^^

This method returns additional messages, allowing you to select which
page you&#39;d like to pull. Note that get\_messages() is page 1. This
returns a list of Message objects as well.

.. code:: python

    my_account.get_more_messages(5)

get\_message(message\_id)
^^^^^^^^^^^^^^^^^^^^^^^^^

This method retrieves the information for the message matching the id
provided

.. code:: python

    email_id = get_messages()[0]
    get_email = my_account.get_message(email_id)
    print get_email.body

Sample Output

::

    This is a test message body. &lt;br&gt; Best, &lt;br&gt; John Smith

get\_inbox()
^^^^^^^^^^^^

This method is identical to get\_messages(), however it returns only the
ten most recent message in the inbox (ignoring messages that were put
into seperate folders by an Outlook rule, junk email, etc)

.. code:: python

    my_account.get_inbox()

Identical methods for additional folders: &#39;get\_sent\_messages()&#39;,
&#39;get\_deleted\_messages()&#39;, &#39;get\_draft\_messages()&#39;.

Interacting with Message objects
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Message objects deal with the JSON returned by Outlook, and provide only
the useful details. These Messages can be forwarded, replied to,
deleted, etc.

forward\_message(to\_recipients, forward\_comment)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

This method forwards a message to the list of recipients, along with an
optional &#39;comment&#39; which is sent along with the message. The
forward\_comment parameter can be set to None to just forward the
message.

.. code:: python

    email = my_account.get_message(id)
    email.forward_message(&#39;John.Adams@domain.com, Nice.Guy@domain.com&#39;, None)
    email.forward_message(&#39;John.Smith@domain.com&#39;, &#39;Read the message below&#39;)

reply(reply\_comment)
^^^^^^^^^^^^^^^^^^^^^

This method allows you to respond to the sender of an email with a
comment appended.

.. code:: python

    email = my_account.get_message(id)
    email.reply(&#39;That was a nice email Lisa&#39;)

reply\_all(reply\_comment)
^^^^^^^^^^^^^^^^^^^^^^^^^^

This method allows you to respond to all recipients an email with a
comment appended (use this wisely).

.. code:: python

    email = my_account.get_message(id)
    email.reply_all(&#39;I am replying to everyone, which will likely annoy 9/10 of those who receive this&#39;)

move\_to\* 
^^^^^^^^^^
You can move a message from one folder to another via several methods. For default folders, there are specific methods - for everything else there is a method to move to a folder designated by its id.

.. code:: python

    message.move_to_ibox()
    message.move_to_deleted()
    message.move_to_drafts()
    message.move_to(my_folder_id)

delete\_message()
^^^^^^^^^^^^^^^^^

Deletes the email. Note that the email will still exist in the user&#39;s
&#39;Deleted Items&#39; folder.

.. code:: python

    message.delete_message()

Sending Emails
~~~~~~~~~~~~~~

After creating an email object, there are several methods which can be
(or must be) used prior to sending which allow you to specify various
pieces of the message to be sent ranging from the subject to
attachments.

Example:

.. code:: python

    test_email = my_account.new_email
    test_email.to(&#39;anEmailAccount@gmail.com&#39;).set_subject(&#39;This is a test subject&#39;).set_body(&#39;This is a test body. &lt;br&gt; Best, &lt;br&gt; John Smith&#39;).add_attachment(&#39;FILE_BYTES_HERE&#39;, &#39;FileName&#39;, &#39;pdf&#39;).send()

Folders
~~~~~~~

Folders can be created, retrieved, moved, copied, renamed, and deleted.
You can also retrieve child folders that are nested within another
folder. All Folder objects contain the folder ID, the folder name, the
folder&#39;s unread count, the number of child folders within it, and the
total items inside the folder.

&#39;Well Known&#39; Folders
^^^^^^^^^^^^^^^^^^^^

Folder ID parameters can be replaced with the following strings where
indicated: &#39;Inbox&#39;, &#39;Drafts&#39;, &#39;SentItems&#39;, or &#39;DeletedItems&#39;

get\_folders()
~~~~~~~~~~~~~~

This methods returns a list of Folder objects representing each folder
in the user&#39;s account.

.. code:: python

    folder = my_account.get_folders()[0]
    print folder.name
    &#39;Inbox&#39;

get\_folder(folder\_id)
~~~~~~~~~~~~~~~~~~~~~~~

If you have the id of a folder, you can get a Folder object for it with
this method

.. code:: python

    folder = my_account.get_folder(the_folder_id)
    print folder.name

Note that you can replace the folder ID parameter with the name of a
&#39;well known&#39; folder such as: &#39;Inbox&#39;, &#39;Drafts&#39;, SentItems&#39;, and
&#39;DeletedItems&#39;

.. code:: python

    folder = my_account.get_folder(&#39;Drafts&#39;)
    print folder.name
    &#39;Drafts&#39;

create\_folder(parent\_folder\_id, new\_folder\_name)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

This methods is called from OutlookAccount(), but returns the Folder
object you have created in Outlook.

.. code:: python

    folder = my_account.get_folders()[0]
    new_folder = my_account.create_folder(folder.id, &#39;My New Folder&#39;)
    print new_folder.unread_count
    &#39;0&#39;

The Folder Object
^^^^^^^^^^^^^^^^^

rename\_folder(new\_folder\_name)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

This method renames the folder object in Outlook, and returns a new
Folder object representing that folder.

.. code:: python

    folder.rename_folder(&#39;My New Folder v2&#39;)

get\_subfolders()
~~~~~~~~~~~~~~~~~

Returns a list of Folder objects, representing all child Folders within
the Folder provided.

.. code:: python

    for folder in folder.get_subfolders():
      print folder.name

    &#39;My New Folder v2&#39;
    &#39;Some Other Folder&#39;

delete\_folder()
~~~~~~~~~~~~~~~~

Self-explanatory, deletes the provided folder in Outlook

.. code:: python

    folder.delete_folder()
    # and now it doesn&#39;t exist

move\_folder(destination\_folder)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Move the Folder provided into a new folder. The new folder parameter can
either be a folder id, or a &#39;well known&#39; folder name.

.. code:: python

    folder.move_folder(&#39;Drafts&#39;)
    folder1.move_folder(folder_id)

copy\_folder(destination\_folder)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Copies the folder and its contents to the designated folder which can be
either a folder ID or well known folder name.
</pre></div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="pyOutlook.html" class="btn btn-neutral" title="Outlook Account" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Jens Astrup.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'b0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>